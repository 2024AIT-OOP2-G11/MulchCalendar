<h3>サイドバー</h3>
<!-- 細かな仕様はユーシンに任せます^^ -->
<a href="{{ url_for('user.add') }}">ユーザー登録</a>
<a href="{{ url_for('user.list') }}">ユーザー一覧</a>

<div>ユーザー選択</div>
<input type="checkbox" class="allselect-button" onclick="checkForAll()">全員
{% for user in users %}
<!-- ↓ VSCode だと，赤い波線が出るかも？ 問題なく動作するはず -->
<div style="color: {{ user.color }};"><input type="checkbox" class="user-button">{{ user.user }}</div>
{% endfor %}


<div>今日の予定</div>
<div>
    <ul id="today-event">
        <!-- ここにチェックボックスで選択されたユーザーの予定を箇条書きかつ色付きで表示 -->
    </ul>
</div>
<!-- pass 考えること="チェックボックスからユーザをどうとる？ 今日の予定をどう抽出する？" -->

<button onclick="">ファイルに出力</button>

<script>
    // チェックボックスの変更を検知して，関数 update() を呼び出す
    document.body.addEventListener('change', update);

    // ユーザー情報を配列に格納（0: 名前，1: 色）
    const users = [
        {% for user in users %}
        ['{{ user.user }}', '{{ user.color }}'],
        {% endfor %}
    ]

    function update() {
        // チェックボックスの状態を取得
        var checkboxes = document.getElementsByClassName('user-button');
        var checkedUsers = [];
        for (var i = 0; i < checkboxes.length; i++) {
            if (checkboxes[i].checked) {
                checkedUsers.push([users[i][0], users[i][1]]);
            }
        }

        // id="today-event" の要素を取得して，中身を更新
        var todayEvent = document.getElementById('today-event');
        todayEvent.innerHTML = '';
        for (var i = 0; i < checkedUsers.length; i++) {
            var user = checkedUsers[i];
            var userEvent = document.createElement('li');
            userEvent.style.color = user[1];
            userEvent.textContent = user[0];
            todayEvent.appendChild(userEvent);
        }
    }

    // チェックボックスの全選択・全解除を行う関数
    function checkForAll() {
        var checked = document.querySelector('.allselect-button').checked;
        var checkboxes = document.getElementsByClassName('user-button');

        for (var i = 0; i < checkboxes.length; i++) {
            checkboxes[i].checked = checked;
        }
    }

</script>
